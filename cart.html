<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!--=============== FLATICON ===============-->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
      integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="style.css" />

    <title>Ecommerce Website</title>
  </head>
  <body>
    <!--=============== HEADER ===============-->
    <header class="header">
      <div class="header_top">
        <div class="header_container container">
          <div class="header_contact">
            <span>(+84)-1234-56789</span>

            <span>Our location</span>
          </div>

          <p class="header_alert-news">
            Super Value Deals - Save more with coupons
          </p>

          <a href="login-register.html" class="header_top-actions">
            Log in / Sign up
          </a>
        </div>
      </div>

      <nav class="nav container">
        <a href="index.html" class="nav_logo">
          <img src="img/logo3.png" alt="" class="nav_logo-img" />
        </a>

        <div class="nav_menu" id="nav-menu">
          <ul class="nav_list">
            <li class="nav_item">
              <a href="index.html" class="nav_link">Home</a>
            </li>

            <li class="nav_item">
              <a href="shop.html" class="nav_link">Shop</a>
            </li>

            <li class="nav_item">
              <a href="account.html" class="nav_link active-link">Cart</a>
            </li>
          </ul>

          <div class="header_search">
            <input
              type="text"
              placeholder="Search for items...."
              class="input_form"
            />

            <button class="search_btn">
              <img src="img/search.png" alt="" />
            </button>
          </div>
        </div>

        <div class="header_user-actions">
          <a href="cart.html" class="header_action-btn">
            <i class="fa-solid fa-cart-shopping"></i>
            <span class="count" id="cart-count">0</span>
          </a>
        </div>
      </nav>
    </header>

    <!--=============== MAIN ===============-->
    <main class="main">
      <!--=============== BREADCRUMB ===============-->
      <section class="breadcrumb">
        <ul class="breadcrumb_list flex container">
          <li><a href="index.html" class="breadcrumb_link">Home</a></li>
          <li><span class="breadcrumb_link">></span></li>
          <li><span class="breadcrumb_link">Cart</span></li>
        </ul>
      </section>

      <!--=============== CART ===============-->
      <section class="cart section_lg container">
        <div class="table_container">
          <table class="table">
            <tr>
              <th>Image</th>
              <th>Name</th>
              <th>Price</th>
              <th>Quantity</th>
              <th>Subtotal</th>
              <th>Remove</th>
            </tr>

            <tbody id="cart-items"></tbody>
            <tbody id="cart-total">
              <!-- Tổng giá tiền sẽ hiển thị ở đây -->
            </tbody>
          </table>
        </div>

        <div class="cart_actions">
          <a  id="purchase-btn"
          class="btn flex btn_md"
          style="float: right; cursor: pointer;"
          >
            Purchase  <i class="fa-solid fa-arrow-right" style="padding-left: 7px;"></i>
          </a>
        </div>
      </section>

      <!--=============== NEWSLETTER ===============-->
      <section class="newsletter section home_newsletter">
        <div class="newsletter_container container grid">
          <h3 class="newsletter_title flex">
            <img src="img/icon-email.svg" class="newsletter_icon" alt="" />
            Sign up Newsletter
          </h3>

          <p class="newsletter_description">
            ... and receive 50% coupon for first shopping.
          </p>

          <form action="" class="newsletter_form">
            <input
              type="text"
              placeholder="Enter your email"
              class="newsletter_input"
            />
            <button type="submit" class="newsletter_btn">Subscribe</button>
          </form>
        </div>
      </section>
    </main>

    <!--=============== FOOTER ===============-->
    <footer class="footer container">
      <div class="footer_container grid">
        <div class="footer_content">
          <a href="index.html" class="footer_logo">
            <img src="img/logo3.png" class="footer_logo-img" />
          </a>

          <h4 class="footer_subtitle">Contact</h4>

          <p class="footer_description">
            <span>Address:</span> 227 Nguyen Van Cu, Phuong 4, District 5, HCM
            city
          </p>

          <p class="footer_description">
            <span>Phone:</span> 0943192824/(+84) 943192824
          </p>

          <p class="footer_description">
            <span>Work hours:</span> 10:00 -18:00, Mon- Sat
          </p>

          <div class="footer_social">
            <h4 class="footer_subtitle">Follow Us</h4>

            <div class="footer_social-links">
              <a href="">
                <img
                  src="img/icon-facebook.svg"
                  alt=""
                  class="footer_social-icon"
                />
              </a>

              <a href="">
                <img
                  src="img/icon-twitter.svg"
                  alt=""
                  class="footer_social-icon"
                />
              </a>

              <a href="">
                <img
                  src="img/icon-instagram.svg"
                  alt=""
                  class="footer_social-icon"
                />
              </a>

              <a href="">
                <img
                  src="img/icon-pinterest.svg"
                  alt=""
                  class="footer_social-icon"
                />
              </a>

              <a href="">
                <img
                  src="img/icon-youtube.svg"
                  alt=""
                  class="footer_social-icon"
                />
              </a>
            </div>
          </div>
        </div>

        <div class="footer_content">
          <h3 class="footer_title">Address</h3>

          <ul class="footer_links">
            <li><a href="" class="footer_link">About Us</a></li>
            <li><a href="" class="footer_link">Delivery Information</a></li>
            <li><a href="" class="footer_link">Privacy Policy</a></li>
            <li><a href="" class="footer_link">Terms & Conditions</a></li>
            <li><a href="" class="footer_link">Contact Us</a></li>
            <li><a href="" class="footer_link">Support Center</a></li>
          </ul>
        </div>

        <div class="footer_content">
          <h3 class="footer_title">My Account</h3>

          <ul class="footer_links">
            <li><a href="" class="footer_link">Sign In</a></li>
            <li><a href="" class="footer_link">View Cart</a></li>
            <li><a href="" class="footer_link">My Wishlist</a></li>
            <li><a href="" class="footer_link">Track my order</a></li>
            <li><a href="" class="footer_link">Help</a></li>
            <li><a href="" class="footer_link">Order</a></li>
          </ul>
        </div>

        <div class="footer_content">
          <h3 class="footer_title">Secured Payment Gateways</h3>

          <img src="img/payment-method.png" alt="" class="payment_img" />
        </div>
      </div>

      <div class="footer_bottom">
        <p class="copyright">
          <i class="fa-regular fa-copyright"></i>2024 Duy Anh. All rights
          reserved
        </p>
        <span class="designer">Designed by: Dao Duy Anh</span>
        <span class="designer">Inspration by: Youtube</span>
      </div>
    </footer>

    <!--=============== SWIPER JS ===============-->
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <!--=============== MAIN JS ===============-->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Lấy giỏ hàng từ localStorage (hoặc tạo mới nếu chưa có)
        let cart = JSON.parse(localStorage.getItem("cart")) || [];

        // Hàm cập nhật số lượng sản phẩm trên biểu tượng giỏ hàng
        function updateCartCount() {
          const itemCount = cart.reduce((sum, item) => sum + item.quantity, 0); // Tổng số lượng sản phẩm
          document.querySelector(".header_user-actions .count").textContent =
            itemCount;
        }

        // Hàm cập nhật tổng giá tiền của giỏ hàng
        function updateTotalPrice() {
          const totalPrice = cart.reduce((sum, item) => {
            const price = parseFloat(item.price.toString().replace(/\./g, ""));
            return sum + price * item.quantity;
          }, 0);

          document.getElementById("cart-total").innerHTML = `
      <tr>
        <td colspan="6" style="text-align:right;">
          <strong>Total: ${totalPrice.toLocaleString()} VND</strong>
        </td>
      </tr>
    `;
        }

        // Hàm hiển thị sản phẩm trong giỏ hàng
        function renderCartItems() {
          const cartItemsContainer = document.getElementById("cart-items");
          cartItemsContainer.innerHTML = ""; // Xóa nội dung cũ trước khi render lại

          if (cart.length > 0) {
            cart.forEach((item) => {
              const price = parseFloat(
                item.price.toString().replace(/\./g, "")
              );
              const subtotal = price * item.quantity;
              const formattedSubtotal = subtotal.toLocaleString();
              const formattedPrice = item.price.toLocaleString();

              const tr = document.createElement("tr");
              tr.innerHTML = `
          <td><img src="${item.image}" alt="" class="table_img"></td>
          <td><h3 class="table_title">${item.name}</h3></td>
          <td><span class="table_price">${formattedPrice} VND</span></td>
          <td><input type="number" class="quantity" value="${item.quantity}" min="1" onchange="updateQuantity('${item.name}', this.value)"></td>
          <td><span class="table_subtotal">${formattedSubtotal} VND</span></td>
          <td><i class="fa-solid fa-trash" onclick="removeItem('${item.name}')"></i></td>
        `;

              cartItemsContainer.appendChild(tr);
            });
          } else {
            const tr = document.createElement("tr");
            tr.innerHTML = `<td colspan="6" style="text-align:center;">Your cart is empty!</td>`;
            cartItemsContainer.appendChild(tr);
          }
        }

        // Hàm xóa sản phẩm khỏi giỏ hàng
        window.removeItem = function (productName) {
          cart = cart.filter((item) => item.name !== productName);
          localStorage.setItem("cart", JSON.stringify(cart));
          renderCartItems();
          updateTotalPrice();
          updateCartCount();
        };

        // Hàm cập nhật số lượng sản phẩm
        window.updateQuantity = function (productName, quantity) {
          const product = cart.find((item) => item.name === productName);
          if (product) {
            product.quantity = parseInt(quantity);
            localStorage.setItem("cart", JSON.stringify(cart));
            renderCartItems();
            updateTotalPrice();
            updateCartCount();
          }
        };

        // Hàm thực hiện chuyển đến trang thanh toán và lưu tổng giá trị giỏ hàng
        function purchase() {
          const totalPrice = cart.reduce(
            (sum, item) =>
              sum +
              parseFloat(item.price.toString().replace(/\./g, "")) *
                item.quantity,
            0
          );
          localStorage.setItem("totalPrice", totalPrice.toLocaleString());
          window.location.href = "checkout.html";
        }

        // Gọi các hàm khởi tạo khi trang tải
        renderCartItems();
        updateTotalPrice();
        updateCartCount();

        // Thêm sự kiện nút thanh toán
        const purchaseButton = document.getElementById("purchase-btn");
        if (purchaseButton) {
          purchaseButton.addEventListener("click", function () {
            const totalPrice = cart.reduce(
              (sum, item) =>
                sum + parseInt(item.price.replace(/,/g, "")) * item.quantity,
              0
            );
            localStorage.setItem("totalPrice", totalPrice.toLocaleString()); // Lưu tổng giá vào localStorage
            window.location.href = "checkout.html"; // Chuyển hướng đến trang checkout.html
          });
        }
      });
    </script>
  </body>
</html>
